install.packages('poLCA')
alpha = rep(0.25, 4)
alpha
p1 = 0.85
p2 = 0.1
p3 = 0.2
P = matrix(c(
  p1,p2,p2,p2,
  p1,p3,p3,p3,
  p2,p1,p2,p2,
  p3,p1,p3,p3,
  p2,p2,p1,p2,
  p3,p3,p1,p3,
  p2,p2,p2,p1,
  p3,p3,p3,p1), nrow=8, ncol=4, byrow = TRUE)
P
library(poLCA)
?simLCA
??simLCA
simLCA
simLCA
poLCA.simLCA
simLCA
X
head(X)
poLCA(f, X, nclass=4, verbose = FALSE)
poLCA(f, X, nclass=2, verbose = FALSE)
?simdata
??simdata
P
X
library(sBIC)
install.packages('sBIC')
library(sBIC)
lcas = LCAs(maxNumClasses=6, numVariables=8, numStatesForVariables=2)
results = sBIC(X, lcas)
results
str(results)
phivec = (6:10)/2
phivec
?plot
plot(1:6, results$sBIC - max(results$sBIC), type='n', xlab='number of latent classes', ylab=expression(bar(SBIC)[phi]))
plot(1:6, results$sBIC - max(results$sBIC), type='n', xlab='number of latent classes', ylab=expression(bar(SBIC)[phi]))
?expression
?cbind
Y1
cbind(Y1, Y2)
f
typeof(f)
?~
results
str(results)
results
?poLCA
data(election)
election
?poLCA
f2a = cbind(MORALG,CARESG,KNOWG,LEADG,DISHONG,INTELG,
                  MORALB,CARESB,KNOWB,LEADB,DISHONB,INTELB)~PARTY
nes2a = poLCA(f2a, election, nclass=3, nrep=5)
head(election) 
nes2a
pidmat = cbind(1, c(1:7))
pidmat
nes2a$coeff
exb = exp(pidmat %*% nes2a$coeff)
exb
matplot(c(1:7),(cbind(1,exb)/(1+rowSums(exb))),ylim=c(0,1),type="l",
         main="Party ID as a predictor of candidate affinity class",
         xlab="Party ID: strong Democratic (1) to strong Republican (7)",
         ylab="Probability of latent class membership",lwd=2,col=1)
text(5.9, 0.35, "other")
text(5.4, 0.7, "Bush")
text(1.8, 0.6, "Gore")
head(election)
str(election)
nes2a$coeff
pidmat
exb
election$PARTY
str(election$PARTY)
party = as.factor(election$PARTY)
party
?poLCA
?poLCA
nes2a$coeff
exb
cbind(1,exb)
rowSums(exb)
cbind(1,exb)/(1+rowSums(exb))
?poLCA
mof
mof
head(mof)
f
?cut
mof
mof$V1
cut(mof$V1)
cut(mof$V1, seq(-5,15))
t = cut(mof$V1, seq(-5,15))
table(t)
mof$V1 * 100
mof$V1 * 1000
mof = mof * 1000
mof
lca = poLCA(f, mof, nclass=2)
mof = mof + 5000
lca = poLCA(f, mof, nclass=2)
mof
as.integer(mof)
as.integer(mof$V1)
mof$V1 = as.integer(mof$V1) + 5
mof
mof$V2 = as.integer(mof$V2) + 5
mof
lca2$posterior
lca2$call
predcell
poLCA.predcell
?poLCA.predcell
poLCA.predcell(lca2, mof)
lca2$predcell
lca2$predclass
?poLCA.posterior
poLCA.posterior(lca2, mof)
mof
typeof(mof)
class(mof)
newmof = c(c(1,5),c(9,15))
newmof
newmof = as.data.frame(newmof)
newmof
newmof = matrix(c(1,5,9,15), nrow=2, ncol=2, byrow = TRUE)
newmof
newmof = as.data.frame(newmof)
newmof
poLCA.posterior(lca2, newmof)
newmof = matrix(c(1,3,12,15), nrow=2, ncol=2, byrow = TRUE)
newmof
mof
newmof
newmof = as.data.frame(newmof)
newmof
poLCA.posterior(lca2, newmof)
newmof = newmof + 5
newmof
poLCA.posterior(lca2, newmof)
mof
as.data.frame(c(11,11))
matrix(c(11,11),ncol = 2,byrow=TRUE)
newmof = matrix(c(11,11),ncol = 2,byrow=TRUE)
newmof = as.data.frame(newmof)
newmof
poLCA.posterior(lca2, newmof)
newmof
poLCA.posterior(lca2, newmof)
newmof = matrix(c(1,3,12,15), nrow=2, ncol=2, byrow = TRUE)
newmof = as.data.frame(newmof)
poLCA.posterior(lca2, newmof)
poLCA
install.packages("devtools")
27
quit()
n
install.packages('mclust')
?getwd
setwd('/home/Users/wenbo/Documents/mysource/kaggle/titanic')
setwd('/home/Users/wenbo/Document/mysource/kaggle/titanic')
getwd
getwd()
setwd('/Users/wenbo/Documents/mysource/kaggle/titanic')
head(tt)
tt$Age
?cut
Z = stats::rnorm(10000)
Z
cut(Z, breaks=-6:6)
table(cut(Z, breaks=-6:6))
?cut
?runif
runif(100, 0, 100)
x = !!
;
.Last.value
runif(100, 0, 100)
.Last.value
x = .Last.value
x
x$tt
x
x = runif(100, 0, 100)
x
u <- cut(x, breaks = c(0, 3, 4.5, 6, 8, Inf), labels = c(1:5))
u
c(1:7)
tt$Age
head(tt)
head(tt)
library(e1071)
install.packages('e1071')
library(e1071)
?lca
install.packages('lcca')
sessionInfo()
library(mclust)
sessionInfo()
data(faithful)
faithful
plot(faithful)
faithcls = Mclust(faithful)
summary(faithcls)
summary(faithcls, parameters = TRUE)
plot(faithcls)
names(faithcls)
faithbic = mclustBIC(faithful)
faithsummary = summary(faithbic, data=faithful)
faithsummary
faithbic
data(wreath)
plot(wreath, pch=20, cex=5)
wreathbic = mclustBIC(wreath)
plot(wreathbic, legendArgs=list(x="topleft"))
wreathbic = mclustBIC(wreath, G=10:20, x = wreathbic)
wreathbic = mclustBIC(wreath)
wreathbic = mclustBIC(wreath, G=1:20, x = wreathbic)
plot(wreathbic, G=10:20, legendArgs=list(x="bottomright"))
summary(wreathbic, wreath)
data(precip)
summary(precip)
head(precip)
plot(precip)
str(precip)
precipcls = Mclust(precip)
summary(precipcls, parameters = TRUE)
plot(precip, legendArgs=list(x="bottomright"))
plot(precipcls, legendArgs=list(x="bottomright"))
plot(precip)
data(tree)
data(trees)
treesbic = mclustBIC(trees)
plot(treesbic, legendArgs=list(x="bottom", ncol=2, cex=0.75))
treesbicprior = mclustBIC(trees, prior=priorControl())
plot(treesbicprior, legendArgs=list(x="bottom", ncol=2, cex=0.75))
tt$Age
library(Matrix)
?sparseMatrix
?model.matrix
model.matrix(Age,Fare~1, data = tt)
?model.matrix
model.matrix(~Age+Fare, data = tt)
m = model.matrix(~Age+Fare, data = tt)
class(m)
m
f
head(m)
m = as.data.frame(m)
m
m$\(Intercept\)
m$(Intercept)
head(m)
f = cbind(Age2, Age3, Age4, Age5, Age6, Fare2, Fare3, Fare4, Fare5) ~ 1
poLCA(f, m)
m = m + 1
m
poLCA(f, m)
length(tt)
dim(tt)
poLCA(f, m, nclass = 4)
#poLCA(f, m, nclass = 4)
f = . ~ 1
poLCA(f, m, nclass = 4)
f = ~ 1
poLCA(f, m, nclass = 4)
names(f)
names(m)
cbind(Age2, Age3)
?Mclust
#ttcls = Mclust()
ttcls = Mclust(tt, G=2)
ttcls
ttclsbic = mclustBIC(tt)
class(tt)
head(tt)
head(tt)
ttclsbic
ttsummary = summary(ttclsbic, data=tt)
ttsummary
?sBIC
tt
binoumix = BinomialMixtures(4, phi = 1)
a = sBIC(tt, binoumix)
?sBIC
?setData.BinomialMixtures
install.packages("knitr")
head(Y)
dim(Y)
class(Y)
typeof(Y)
numTrials
tt
class(tt)
tt
tt
results
results
plot(results)
?LCAs
head(tt)
tt$Age
tt$Fare
tt$Age
tt$Fare
tt$Age
tt$Fare
tt$ischild
tt$ischild
tt$ischild
tt
levels(tt$SibSp)
tt$SibSp
tt
head(m)
?model.matrix
?sparse.model.matrix
m2 = sparse.model.matrix(~., data=tt)
m2
head(m2)
head(m)
head(tt)
f = cbind(Age, Embarked, Entourage, Fare, Parch, Pclass, Sex, SibSp, FamilySize, ischild, isfather, ismother, ishusband, iswife, isentourage) ~ 1
poLCA(f, tt)
head(tt)
dimnames(tt)
tt
class(tt)
names(tt)
f
poLCA(f, tt)
class(tt)
tt$names
names(tt)
poLCA(f, as.matrix(tt))
poLCA(f, tt0
poLCA(f, tt)
?poLCA
f
dimnames(tt)[2]
length(dimnames(tt)[2])
length(dimnames(tt)[[2]])
head(tt)
poLCA
str(tt)
tt$Age = as.numeric(as.character(tt$Age))
str(tt)
tt$Fare = as.numeric(as.character(tt$Fare))
str(tt)
poLCA(f, tt)
poLCA(f, tt, nclass=3)
poLCA(f, tt, nclass=4)
poLCA(f, tt, nclass=5)
poLCA(f, tt, nclass=6)
poLCA(f, tt, nclass=7)
poLCA(f, tt, nclass=10)
poLCA(f, tt, nclass=15)
poLCA(f, tt, nclass=16)
lca = LCAs(maxNumClasses = 6, numVariables=15, numStatesForVariables = 11)
bic = sBIC(tt, lca)
bic
poLCA(f, tt, nclass=3, nrep=5)
poLCA(f, tt, nclass=4, nrep=5)
poLCA(f, tt, nclass=5, nrep=5)
poLCA(f, tt, nclass=5, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
f = cbind(Age, Embarked, Entourage, Fare, Parch, Pclass, Sex, SibSp, FamilySize, ischild, isfather, ismother, ishusband, iswife, isentourage) ~ Survived
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=20)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=5)
str(tt)
str(tt)
poLCA(f, tt, nclass=8, nrep=5)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca = poLCA(f, tt, nclass=8, nrep=10)
lca
lca$posterior
head(lca$posterior)
head(tt)
tail(tt)
tail(lca$posterior)
tt[886:891]
tt[886:891,]
lca = poLCA(f, tt, nclass=16, nrep=10)
lca = poLCA(f, tt, nclass=16, nrep=10)
f = cbind(Age, Embarked, Entourage, Fare, Parch, Pclass, Sex, SibSp, FamilySize, ischild, isfather, ismother, ishusband, iswife, isentourage) ~ 1
lca = poLCA(f, tt, nclass=16, nrep=10)
lca = poLCA(f, tt, nclass=32, nrep=10)
head(lca$posterior)
lca64 = poLCA(f, tt, nclass=64, nrep=10)
quit()
n
